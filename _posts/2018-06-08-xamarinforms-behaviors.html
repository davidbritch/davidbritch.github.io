---
layout: post
title: 'Xamarin.Forms Behaviors: EventHandlerBehavior and the SourceObject'
date: '2018-06-08T09:03:00.001+01:00'
author: David Britch
tags:
- behaviour
- C#
- Xamarin
modified_time: '2018-06-08T09:03:21.565+01:00'
blogger_id: tag:blogger.com,1999:blog-8265682915956744370.post-8686919287009802763
blogger_orig_url: https://dbritch.blogspot.com/2018/06/xamarinforms-behaviors.html
---

<p>I <a href="https://www.davidbritch.com/2018/05/behaviours-library-14.html" target="_blank">previously</a> mentioned that I’d published v1.4 of my Behaviors library, and that it included some new functionality. In my <a href="https://www.davidbritch.com/2018/05/xamarinforms-behaviors-gotostateaction.html" target="_blank">last blog post</a> I looked at the <strong>GoToStateAction</strong>, which is the main item of new functionality. Another new item is the <strong>SourceObject</strong> property that now exists on the <strong>EventHandlerBehavior</strong> class.</p> <p>Prior to this addition, to use the <strong>EventHandlerBehavior</strong> you’d set the <strong>EventName</strong> property to the event that you want the behavior to listen to, and the <strong>EventHandlerBehavior</strong> would automatically look for this event on the <strong>VisualElement</strong> the behavior is attached to. The following XAML shows an example of this syntax:</p> <div class="wlWriterSmartContent" id="scid:9D7513F9-C04C-4721-824A-2B34F0212519:c40ae50b-04e1-4eac-a003-c3ac8e42b30c" style="margin: 0px; padding: 0px; float: none; display: inline;"><pre style="width: 851px; height: 170px; overflow: visible; background-color: white;"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">ListView </span><span style="color: rgb(255, 0, 0);">ItemsSource</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{Binding People}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
    </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">ListView.Behaviors</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
        </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">behaviors:EventHandlerBehavior </span><span style="color: rgb(255, 0, 0);">EventName</span><span style="color: rgb(0, 0, 255);">="ItemSelected"</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
            </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">behaviors:InvokeCommandAction </span><span style="color: rgb(255, 0, 0);">Command</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{Binding ItemSelectedCommand}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(255, 0, 0);"> 
                                           Converter</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{StaticResource SelectedItemConverter}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(255, 0, 0);"> </span><span style="color: rgb(0, 0, 255);">/&gt;</span><span style="color: rgb(0, 0, 0);">
            </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">behaviors:InvokeCommandAction </span><span style="color: rgb(255, 0, 0);">Command</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{Binding OutputAgeCommand}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(255, 0, 0);"> 
                                           Converter</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{StaticResource SelectedItemConverter}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(255, 0, 0);"> </span><span style="color: rgb(0, 0, 255);">/&gt;</span><span style="color: rgb(0, 0, 0);">
        </span><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">behaviors:EventHandlerBehavior</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
    </span><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">ListView.Behaviors</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
</span><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">ListView</span><span style="color: rgb(0, 0, 255);">&gt;</span></div></pre><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>Here, when the <strong>ListView.ItemSelected</strong> event fires, the <strong>ItemSelectedCommand</strong> and <strong>OutputAgeCommand</strong> are sequentially executed. To stress the point again, the <strong>EventHandlerBehavior</strong> automatically looks for the <strong>ItemSelected</strong> event on the <strong>VisualElement</strong> the behavior is attached to – in this case, the <strong>ListView</strong>.</p>
<h3>Introducing the SourceObject Property</h3>
<p>In v1.4 of the Behaviors library, the <strong>EventHandlerBehavior</strong> has the following properties:</p>
<ul>
<li><strong>EventName</strong> – the name of the event to listen to, which must exist on the <strong>SourceObject</strong>.</li>
<li>(optional) <strong>SourceObject</strong> – the object on which the behavior should listen for the event specified by the <strong>EventName</strong> property. If not provided, the behavior will default to listening for the event on the <strong>VisualElement</strong> the behavior is attached to.</li>
<li><strong>Actions</strong> – one of more actions that should be executed in response to the event firing. However, this property is typically set indirectly by specifying the action instances (<strong>InvokeCommandAction</strong>, <strong>SetPropertyAction</strong> etc.) as children of the <strong>EventHandlerBehavior</strong> instance.</li></ul>
<p>By making the <strong>SourceObject</strong> property optional, and by defaulting it to listening for the event on the <strong>VisualElement</strong> the behavior is attached to, backwards compatibility with existing codebases is ensured.</p>
<p>The following code example shows an example of specifying the <strong>SourceObject</strong> property:</p>
<p>
<div class="wlWriterSmartContent" id="scid:9D7513F9-C04C-4721-824A-2B34F0212519:efa9a063-eb72-46d1-9815-125d8fb5156c" style="margin: 0px; padding: 0px; float: none; display: inline;"><pre style="width: 851px; height: 361px; overflow: visible; background-color: white;"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">ListView </span><span style="color: rgb(255, 0, 0);">x:Name</span><span style="color: rgb(0, 0, 255);">="listView"</span><span style="color: rgb(255, 0, 0);"> ItemsSource</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{Binding People}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
    </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">ListView.Behaviors</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
        </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">behaviors:EventHandlerBehavior </span><span style="color: rgb(255, 0, 0);">EventName</span><span style="color: rgb(0, 0, 255);">="ItemSelected"</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
            </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">behaviors:InvokeCommandAction </span><span style="color: rgb(255, 0, 0);">Command</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{Binding ItemSelectedCommand}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(255, 0, 0);"> 
                                           Converter</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{StaticResource SelectedItemConverter}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(255, 0, 0);"> </span><span style="color: rgb(0, 0, 255);">/&gt;</span><span style="color: rgb(0, 0, 0);">
            </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">behaviors:InvokeCommandAction </span><span style="color: rgb(255, 0, 0);">Command</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{Binding OutputAgeCommand}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(255, 0, 0);"> 
                                           Converter</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{StaticResource SelectedItemConverter}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(255, 0, 0);"> </span><span style="color: rgb(0, 0, 255);">/&gt;</span><span style="color: rgb(0, 0, 0);">
        </span><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">behaviors:EventHandlerBehavior</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
    </span><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">ListView.Behaviors</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
</span><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">ListView</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
</span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">Label </span><span style="color: rgb(255, 0, 0);">x:Name</span><span style="color: rgb(0, 0, 255);">="itemSelectedLabel"</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
    </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">Label.Behaviors</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
        </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">behaviors:EventHandlerBehavior </span><span style="color: rgb(255, 0, 0);">EventName</span><span style="color: rgb(0, 0, 255);">="ItemSelected"</span><span style="color: rgb(255, 0, 0);"> 
                                        SourceObject</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{x:Reference listView}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
            </span><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">behaviors:SetPropertyAction </span><span style="color: rgb(255, 0, 0);">TargetObject</span><span style="color: rgb(0, 0, 255);">="</span><span style="color: rgb(128, 128, 0);">{x:Reference itemSelectedLabel}</span><span style="color: rgb(0, 0, 255);">"</span><span style="color: rgb(255, 0, 0);"> 
                                         PropertyName</span><span style="color: rgb(0, 0, 255);">="Text"</span><span style="color: rgb(255, 0, 0);"> 
                                         Value</span><span style="color: rgb(0, 0, 255);">="Item selected in ListView."</span><span style="color: rgb(255, 0, 0);"> </span><span style="color: rgb(0, 0, 255);">/&gt;</span><span style="color: rgb(0, 0, 0);">
         </span><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">behaviors:EventHandlerBehavior</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">     
    </span><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">Label.Behaviors</span><span style="color: rgb(0, 0, 255);">&gt;</span><span style="color: rgb(0, 0, 0);">
</span><span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">Label</span><span style="color: rgb(0, 0, 255);">&gt;</span></div></pre><!-- Code inserted with Steve Dunn's Windows Live Writer Code Formatter Plugin.  http://dunnhq.com --></div>
<p>As before, when the <strong>ListView.ItemSelected</strong> event fires, the <strong>ItemSelectedCommand</strong> and <strong>OutputAgeCommand</strong> are sequentially executed. Here, because the first <strong>EventHandlerBehavior</strong> instance doesn’t specify a <strong>SourceObject</strong>, the behavior automatically looks for the <strong>ItemSelected</strong> event on the <strong>VisualElement</strong> the behavior is attached to – in this case, the <strong>ListView</strong>.</p>
<p>The <strong>EventHandlerBehavior</strong> instance that’s attached to the <strong>Label</strong> also listens for the <strong>ItemSelected</strong> event on the <strong>ListView</strong>, even though the behavior is attached to a <strong>Label</strong>. This is achieved by specifying the <strong>SourceObject</strong> as a reference to the <strong>ListView</strong>. Therefore, when the <strong>ListView.ItemSelected</strong> event fires, the <strong>SetPropertyAction</strong> instance updates the <strong>Label.Text</strong> property with the text specified by the <strong>Value</strong> property. Note that this example is completely contrived. It would be simpler to just move the <strong>SetPropertyAction</strong> instance to be a child of the first <strong>EventHandlerBehavior</strong> instance and remove the behavior instance from the <strong>Label</strong> (only one <strong>EventHandlerBehavior</strong> instance in the XAML then, instead of two). However, it illustrates that it’s now possible to specify an <strong>EventHandlerBehavior</strong> that listens for events on objects other than the <strong>VisualElement</strong> the behavior is attached to. This makes it possible to attach an <strong>EventHandlerBehavior</strong> instance to a <strong>VisualElement</strong> that the actions operate on, which can aid code readability.</p>
<h3>Summary</h3>
<p>The <strong>EventHandlerBehavior</strong> now has a <strong>SourceObject</strong> property that can be set to the object on which the behavior should listen for the event specified by the <strong>EventName</strong> property. If not provided, the <strong>EventHandlerBehavior</strong> will default to the <strong>VisualElement</strong> the behavior is attached to.</p>
<p>The sample application that this code comes from can be downloaded from <a href="https://github.com/davidbritch/behaviors" target="_blank">GitHub</a>, and the Behaviors library can be found on <a href="https://www.nuget.org/packages/Behaviors.Forms/" target="_blank">NuGet</a>.</p>