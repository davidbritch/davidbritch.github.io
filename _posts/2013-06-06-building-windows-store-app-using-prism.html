---
title: Building a Windows Store app using Prism and manual dependency injection
date: '2013-06-06T14:13:00.001+01:00'
author: David Britch
tags:
- MVVM
- C#
- Prism for the Windows Runtime
- Windows 8
- WinRT
- Windows Store app
modified_time: '2013-06-06T14:14:46.408+01:00'
blogger_id: tag:blogger.com,1999:blog-8265682915956744370.post-5215850376344937384
blogger_orig_url: https://dbritch.blogspot.com/2013/06/building-windows-store-app-using-prism.html
---

<p><a href="http://www.davidbritch.com/2013/05/building-windows-store-app-using-prism.html">Previously</a> Iâ€™ve demonstrated how to use <a href="http://msdn.microsoft.com/en-us/library/windows/apps/xx130643.aspx">Prism for the Windows Runtime</a> by writing a sample photo viewing app. In the app there are two pages. The first page presents a thumbnail gallery view of photos in the users Pictures library. Clicking on a thumbnail takes the user to the second page which displays the full image. In the app, support for MVVM, navigation, and state management are all provided by <a href="http://msdn.microsoft.com/en-us/library/windows/apps/xx130643.aspx">Prism for the Windows Runtime</a>.</p> <p>The app registered types and instances that are used in the view model constructors with the <a href="http://unity.codeplex.com/">Unity</a> dependency injection container. However, you are not required to use <a href="http://unity.codeplex.com/">Unity</a>, or any other dependency injection container, when bootstrapping Windows Store apps using Prism. An alternative approach is to perform manual dependency injection to pass client service references to view models by registering factory methods against view types, in the <strong>App.OnInitialize</strong> method.</p> <div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: 'Courier New', courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper"> <div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px" id="codeSnippet"><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: white; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px"><span style="color: #0000ff">protected</span> <span style="color: #0000ff">override</span> <span style="color: #0000ff">void</span> OnInitialize(IActivatedEventArgs args)</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">{</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: white; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">    var FileSystemRepository = <span style="color: #0000ff">new</span> FileSystemRepository();</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">    ViewModelLocator.Register(<span style="color: #0000ff">typeof</span>(MainPage).ToString(), () =&gt; <span style="color: #0000ff">new</span> MainPageViewModel(FileSystemRepository, NavigationService));</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: white; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">    ViewModelLocator.Register(<span style="color: #0000ff">typeof</span>(PhotoPage).ToString(), () =&gt; <span style="color: #0000ff">new</span> PhotoPageViewModel(FileSystemRepository, NavigationService));</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">}</pre></div></div><p>This method creates a singleton from the <strong>FileSystemRepository</strong> class, The <strong>FileSystemRepository</strong> class provides image data for display on both pages of the app. The <strong>OnInitialize</strong> method then registers a factory method for each view type with the static <strong>ViewModelLocator </strong>object, This ensures that the <strong>ViewModelLocator</strong> object instantiates the correct view model object for a view type, passing in dependent services to the view model constructor from the factory method. This alternative approach avoids using a dependency injection container, for those who prefer not to.</p><h3>Summary</h3><p><a href="http://msdn.microsoft.com/en-us/library/windows/apps/xx130643.aspx">Prism for the Windows Runtime</a> can accelerate the development of Windows Store apps by providing support for MVVM, loosely coupled communication, and the core services required in Windows Store apps. As well as allowing you to use a container for dependency resolution and construction, Prism also allows you to explicitly specify how to construct a view model for a given view type.</p><p>The sample app can be downloaded <a href="http://sdrv.ms/15DUa97">here</a>.</p>  