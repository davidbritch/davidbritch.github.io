---
title: Improving code quality by using NDepend
date: '2013-08-22T17:13:00.001+01:00'
author: David Britch
tags:
- Static analysis
modified_time: '2013-08-22T17:14:03.053+01:00'
thumbnail: http://lh3.ggpht.com/-28KNyG0Z1ag/UhY4rbVHZHI/AAAAAAAACiU/M8_rFiNsKWQ/s72-c/image_thumb1.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-8265682915956744370.post-7788191543374288415
blogger_orig_url: https://dbritch.blogspot.com/2013/08/ndepend.html
---

<p>Over the past few years I’ve been using many of the tools included with Visual Studio to analyse my code. This has included running code metrics, examining test coverage, and undertaking performance analysis. However, for my money the tools that are baked into Visual Studio don’t really go far enough. While they are continuously improving there are also quite a few gaps in the data they’ll provide to you, and it’s not always a trivial task to translate that data into improved code quality. Enter NDepend.</p> <p><a href="http://ndepend.com/">NDepend</a> is a static analysis tool designed to improve code quality by using code metrics and enforcing a series of rules. It can be used as a stand alone tool, integrates with Visual Studio, and also can integrate with your build process so that you can be regularly advised of the NDepend analysis results. There are all kinds of features in the tool including viewing dependency graphs, running code metrics, and running custom queries on your code. For a full list you should see <a href="http://ndepend.com/Features.aspx">here</a>.</p> <p>When you run the standalone tool you can create/open an NDepend project, analyse a code base, or compare two versions of a code base. Once you’ve analysed your code base you’re presented with a detailed screen of results.</p> <p><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/-28KNyG0Z1ag/UhY4rbVHZHI/AAAAAAAACiU/M8_rFiNsKWQ/image_thumb1.png?imgmax=800" width="840" height="460"></p> <p>You can examine a dependency graph and dependency matrix, which both allow you to detect dependency cycles between components (NDepend can also suggest the best way to remove a particular dependency cycle). The metrics view presents a graphical view of your chosen metric applied to your chosen level (field, method, type, namespace, assembly). NDepend includes a whole series of code metrics, related to code organization, structure, quality, and coverage, which you can use to improve your code quality.</p> <p>However, the most useful and powerful feature to me is CQLinq which gives you the ability to query your code using LINQ-style queries. For example, you can run CQLinq queries to check:</p> <ul> <li>The classes that implement a particular interface.  <li>Which methods could have a more restricted visibility.  <li>Which methods are not covered by unit tests.  <li>That overrides of Method() call base.Method().  <li>Whether the UI layer directly uses specific types.  <li>Whether your objects are immutable and pure.</li></ul> <p>NDepend comes with 200 queries, spread over 18 categories including code quality, design, architecture and layering, dead code, visibility, purity, and naming conventions. You can use all the existing queries as is, or adapt them for your own needs. You can also write new CQLinq queries to check/enforce your own criteria. When you select a query category you are presented with a list of queries contained within the category.</p> <p><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/-LOmednAWcZo/UhY4sGkmzYI/AAAAAAAACic/AD9KL9HQOWU/image_thumb%25255B1%25255D.png?imgmax=800" width="840" 244?></p> <p>When you select a particular query it immediately executes, displaying the results in a docked window. The code for the query is also shown, enabling you to customise it as required. For instance, when the “Methods that could have a lower visibility” query is executed, you are presented with a list of potentially offending methods, their current visibility, and a suggested lower visibility. Selecting the offending method opens it in Visual Studio where you can change its visibility. This is a very efficient way of performing such a task in comparison to scrutinising visibilities manually.</p> <p>There’s all kinds of other features available in NDepend, far too many to list here in fact. So if you are in need of a static analysis tool it’s well worth taking a look at it. It’s easy to use, the CQLinq feature makes it very powerful, and it goes a lot further than any of the tools included with Visual Studio. Check it out!</p>  