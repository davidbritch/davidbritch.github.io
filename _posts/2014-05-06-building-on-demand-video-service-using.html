---
title: Building an On-Demand Video Service using Microsoft Azure Media Services
date: '2014-05-06T10:19:00.000+01:00'
author: David Britch
tags:
- Azure Media Services
- C#
- Windows 8
- WinRT
- Windows Store app
modified_time: '2014-05-06T10:20:07.993+01:00'
thumbnail: http://lh5.ggpht.com/-gWH1cLtrOUw/U2ipRZbbE9I/AAAAAAAACmk/agb2sbB3wGQ/s72-c/overview_thumb.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-8265682915956744370.post-5164534213530072424
blogger_orig_url: https://dbritch.blogspot.com/2014/05/building-on-demand-video-service-using.html
---

<p>The <a href="http://pnp.azurewebsites.net/en-us/">patterns &amp; practices</a> group at Microsoft have just released a guide and reference implementation for a new project called <a href="http://msdn.microsoft.com/en-us/library/dn735912.aspx">Building an On-Demand Video Service with Microsoft Azure Media Services</a>. As a team member of the project, and someone with an interest in the unique challenges of building video-on-demand services, I thought I'd describe the project. <h5>What’s it all about?</h5> <p>Traditionally, building the workflow for the creation, management, and distribution of media is problematic. It involves having to integrate multiple technologies and providers, some of which may be incompatible. In addition, it can require a huge investment in infrastructure, which may not always be fully utilized. These issues can result in a non-standardized workflow that is not easily scaled, and that requires coordination at different stages of the workflow.  <p>Azure Media Services allow you to build scalable, cost effective, end-to-end media distribution solutions that can upload, encode, package, and stream media to Windows, iOS, Android, Adobe Flash, and other devices and platforms.  <p>The <a href="http://msdn.microsoft.com/en-us/library/dn735912.aspx">guide</a> describes how to design and build a video-on-demand application that uses Media Services. It provides an end to end walkthrough of a Windows Store application that communicates with Media Services through a web service, and explains key design and implementation choices. In addition to the Windows Store application, client applications are also available for Windows Phone, Web, iOS, and Android.  <p>The guide describes:  <ul> <li>The standard workflow of a media solution that uses Media Services.  <li>How to use Media Services metadata in a content management system.  <li>How to securely upload, process, and deliver media.  <li>How to use Windows Azure Storage Queues to control the encoding process.  <li>How to deliver video-on-demand in multiple adaptive streaming formats in order to support client applications on different platforms and devices.  <li>How to scale media encoding and delivery.</li></ul> <p>In addition to describing the client applications, their integration with Azure Media Services, and the decisions made during the design and implementation, the guide discusses related factors, such as the design patterns used, and the ways that the application could be extended or modified for other scenarios.  <p>The result is that, after reading the guide, you will be familiar with the basic principles of Media Services, and you will be able to design and implement client applications that use Media Services to provide scalable, cost effective, end-to-end media distribution solutions.  <h5>What’s in the reference implementation?</h5> <p>The following diagram shows a high-level overview of the reference implementation.  <p><a href="http://lh4.ggpht.com/-yEdxXOYsS5c/U2ipQmUJK7I/AAAAAAAACmc/lxoJWdqdKP8/s1600-h/overview%25255B2%25255D.png"><img title="overview" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="overview" src="http://lh5.ggpht.com/-gWH1cLtrOUw/U2ipRZbbE9I/AAAAAAAACmk/agb2sbB3wGQ/overview_thumb.png?imgmax=800" width="244" height="149"></a> <p>Client applications communicate with the video-on-demand service through a REST web interface. This interface allows applications to retrieve, upload, and publish videos. When a video is uploaded for processing by Media Services it is stored in Microsoft Azure Storage, with the video details being stored in the CMS. It's then encoded to a set of adaptive bitrate MP4s, which can be converted by dynamic packaging to smooth streaming, HLS, or MPEG-DASH, on demand. For more information about dynamic packaging see <a href="http://msdn.microsoft.com/en-us/library/dn735905.aspx#sec3">Azure Media Services dynamic packaging</a>.  <p>When a video is consumed by applications, its URL is retrieved from the CMS and returned to the application. The application then requests the URL content from the Media Services Origin Service, which processes the outbound stream from storage to client app. For more information about the Origin Service, see <a href="http://msdn.microsoft.com/en-us/library/dn735905.aspx#sec2">Azure Media Services Origin Service</a>.  <p>The solution comprises three main components:  <ul> <li>The user facing client applications, implemented for the Windows Runtime, Windows Phone, Web, iOS, and Android. These applications allow users to browse videos, and control the playback of videos. In addition the applications allow users to capture and upload new videos for encoding by Media Services, which can then be consumed from the CMS once encoding has completed. </li> <li>The business logic, implemented as a web service. The Contoso web service exposes the data and operations that it supports through a REST interface. Separating the business logic in this way decouples it from the client applications, minimizing the impact that any changes to the implementation of the applications will have on this business logic. </li> <li>Data storage, provided by a Microsoft Azure SQL database, and by Microsoft Azure Storage. The CMS, which stores details of videos and encoding jobs, is implemented as a Microsoft Azure SQL database. However, uploaded videos and encoded videos output by Media Services are stored in Microsoft Azure Storage. </li></ul> <h5>Who is it intended for?</h5> <p>The guide and reference implementation is intended for architects, developers, and information technology professionals who design, build, or maintain video-on-demand or online video portal applications and services, particularly those that integrate with content management systems.  <h5>Where can I get help?</h5> <p>Patterns for Scalable Media Hosting, like many patterns &amp; practices deliverables, has a community site. On the community site you can post questions, provide feedback, connect with other users to share ideas, and find additional content such as extensions and training material. Community members can also help Microsoft plan and test future releases of Prism for the Windows Runtime. For more info see <a href="https://wamsg.codeplex.com/">patterns &amp; practices: Microsoft Azure Media Services Guidance</a>. </p>  