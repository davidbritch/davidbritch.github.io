---
layout: post
title: Creating a model class with validation support using Prism for the Windows
  Runtime
date: '2013-07-22T10:22:00.000+01:00'
author: David Britch
tags:
- MVVM
- C#
- Prism for the Windows Runtime
- Windows 8
- WinRT
- Windows Store app
modified_time: '2013-07-22T10:23:27.042+01:00'
blogger_id: tag:blogger.com,1999:blog-8265682915956744370.post-6389463765704971153
blogger_orig_url: https://dbritch.blogspot.com/2013/07/creating-model-class-with-validation.html
---

<p>The Windows Runtime has no in-built support for validation. Therefore in <a href="http://prismwindowsruntime.codeplex.com/">Prism for the Windows Runtime</a> we added functionality to allow validation of user input and notification of validation errors back to the user. For more info see <a href="http://msdn.microsoft.com/en-us/library/windows/apps/xx130659.aspx">Validating user input in AdventureWorks Shopper</a>.</p> <p>In order to demonstrate the validation features of Prism I’ve decided to create a new small sample app. The app allows the user to enter their name, and then performs validation of the user input.</p> <h3>Implementation</h3> <p>The <a href="http://msdn.microsoft.com/en-us/library/windows/apps/xx130655.aspx#StoreAppsLibrary">Microsoft.Practices.Prism.StoreApps</a> library provides validation support to apps. In order to use Prism’s validation support your model classes must derive from the <strong>ValidatableBindableBase</strong> class. This class provides an error container whose contents are updated whenever a model class property value changes. The <strong>ValidatableBindableBase</strong> class derives from Prism’s <strong>BindableBase</strong> class, which raises property change notification events.</p> <h5>Specifying validation rules</h5> <p>Validation rules are specified by adding data annotation attributes that derive from the <a title="ValidationAttribute" href="http://msdn.microsoft.com/en-us/library/windows/apps/system.componentmodel.dataannotations.validationattribute.aspx">ValidationAttribute</a> class to the declaration of the model property that you want to validate.</p> <div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: 'Courier New', courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper"> <div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px" id="codeSnippet"><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: white; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px"><span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> Person : ValidatableBindableBase</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">{</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: white; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">    <span style="color: #0000ff">private</span> <span style="color: #0000ff">string</span> _name;</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">&nbsp;</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: white; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">    <span style="color: #0000ff">private</span> <span style="color: #0000ff">const</span> <span style="color: #0000ff">string</span> RegexPattern = <span style="color: #006080">@"\A\p{L}+([\p{Zs}\-][\p{L}]+)*\z"</span>;</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">&nbsp;</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: white; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">    [Required(ErrorMessage = <span style="color: #006080">"Name is required"</span>)]</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">    [RegularExpression(RegexPattern, ErrorMessage = <span style="color: #006080">"Name must contain only letters and spaces. Hypens are also allowed, but they cannot occur in sequences."</span>)]</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: white; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">    <span style="color: #0000ff">public</span> <span style="color: #0000ff">string</span> Name</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">    {</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: white; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">        get { <span style="color: #0000ff">return</span> _name; }</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">        set { SetProperty(<span style="color: #0000ff">ref</span> _name, <span style="color: #0000ff">value</span>); }</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: white; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">    }</pre><!--CRLF--><pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; background-color: #f4f4f4; margin: 0em; border-left-style: none; padding-left: 0px; width: 100%; padding-right: 0px; font-family: 'Courier New', courier, monospace; direction: ltr; border-top-style: none; color: black; border-right-style: none; font-size: 8pt; overflow: visible; padding-top: 0px">}</pre><!--CRLF--></div></div><p>In the <strong>Person </strong>class the <strong>Name</strong> property contains a <a href="http://msdn.microsoft.com/en-us/library/windows/apps/system.componentmodel.dataannotations.requiredattribute.aspx">Required</a> attribute which specifies that a validation failure will occur if the field is null, contains an empty string, or contains only white-space characters. The <a href="http://msdn.microsoft.com/en-us/library/windows/apps/system.componentmodel.dataannotations.regularexpressionattribute.aspx">RegularExpression</a> attribute specifies that the <strong>Name</strong> property must match the regular expression given by the <strong>RegexPattern</strong> constant. This regular expression allows user input to consist of all unicode name characters as well as spaces and hyphens, as long as the spaces and hyphens don’t occur in sequences and are not leading or trailing characters. Each validation attribute also specifies the error message that will be returned to the user if validation fails.</p><h5>Triggering validation when properties change</h5><p>The <strong>SetProperty</strong> method in the <strong>ValidatableBindableBase</strong> class performs validation when a model property is set to a new value. The <strong>ValidatableBindableBase.SetProperty</strong> calls the <strong>BindableBase.SetProperty</strong> method, and then performs validation of the property value if it has changed. For more info about Prism’s internal implementation of this see <a href="http://msdn.microsoft.com/en-us/library/windows/apps/xx130659.aspx">Validating user input in AdventureWorks Shopper</a>.</p><h3>Summary</h3><p>In this blog post I’ve created a model class with validation support. The <strong>Person</strong> class derives from Prism’s <strong>ValidatableBindableBase</strong> class, and has a property, <strong>Name</strong>, that possesses data annotation attributes that derive from the <a title="ValidationAttribute" href="http://msdn.microsoft.com/en-us/library/windows/apps/system.componentmodel.dataannotations.validationattribute.aspx">ValidationAttribute</a> class to specify validation rules. When the value of the <strong>Name</strong> property changes validation is performed by calling the <strong>ValidatableBindableBase.SetProperty</strong> method.</p><p>In my next blog post I’ll hook up the model class with code that notifies the user of any validation errors.</p>  